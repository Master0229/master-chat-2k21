<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!------ Include the above in your HEAD tag ---------->


<html>

<head>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" type="text/css"
        rel="stylesheet">
    <link rel="stylesheet" href="./style.css">
    <script>
        var name = prompt("Please enter your name");
    </script>
</head>

<body>
    <div class="container">
        <!-- <h3 class=" text-center">Messaging</h3> -->
        <div class="messaging">
            <div class="inbox_msg">
                <!-- <div class="inbox_people">
                    <div class="headind_srch">
                        <div class="recent_heading">
                            <h4>Recent</h4>
                        </div>
                        <div class="srch_bar">
                            <div class="stylish-input-group">
                                <input type="text" class="search-bar" placeholder="Search">
                                <span class="input-group-addon">
                                    <button type="button"> <i class="fa fa-search" aria-hidden="true"></i> </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div id="inbox" class="inbox_chat">
                        <div class="chat_list active_chat">
                            <div class="chat_people">
                                <div class="chat_img"> <img src="https://ptetutorials.com/images/user-profile.png"
                                        alt="sunil"> </div>
                                <div class="chat_ib">
                                    <h5>Sunil Rajput <span class="chat_date">Dec 25</span></h5>
                                    <p>Test, which is a new approach to have all solutions
                                        astrology under one roof.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
                <div class="mesgs">
                    <div id="message_box" class="msg_history">
                        <div class="incoming_msg">
                            <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png"
                                    alt="sunil"> </div>
                            <div class="received_msg">
                                <div class="received_withd_msg">
                                    <p>Test which is a new approach to have all
                                        solutions</p>
                                    <span class="time_date"> 11:01 AM | June 9</span>
                                </div>
                            </div>
                        </div>
                        <div class="outgoing_msg">
                            <div class="sent_msg">
                                <p>Test which is a new approach to have all
                                    solutions</p>
                                <span class="time_date"> 11:01 AM | June 9</span>
                            </div>
                        </div>
                        <!-- <div class="incoming_msg">
                            <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png"
                                    alt="sunil"> </div>
                            <div class="received_msg">
                                <div class="received_withd_msg">
                                    <p>Test, which is a new approach to have</p>
                                    <span class="time_date"> 11:01 AM | Yesterday</span>
                                </div>
                            </div>
                        </div>
                        <div class="outgoing_msg">
                            <div class="sent_msg">
                                <p>Apollo University, Delhi, India Test</p>
                                <span class="time_date"> 11:01 AM | Today</span>
                            </div>
                        </div>
                        <div class="incoming_msg">
                            <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png"
                                    alt="sunil"> </div>
                            <div class="received_msg">
                                <div class="received_withd_msg">
                                    <p>We work directly with our designers and suppliers,
                                        and sell direct to you, which means quality, exclusive
                                        products, at a price anyone can afford.</p>
                                    <span class="time_date"> 11:01 AM | Today</span>
                                </div>
                            </div>
                        </div> -->
                    </div>
                    <div class="type_msg">
                        <div class="input_msg_write">
                            <input type="text" id="message" class="write_msg" placeholder="Type a message" />
                            <button onclick="sendmessage()" class="msg_send_btn" type="button"><i
                                    class="fa fa-paper-plane-o" aria-hidden="true"></i></button>
                        </div>
                    </div>
                </div>
            </div>


            <!-- <p class="text-center top_spac"> Design by <a target="_blank"
                    href="https://www.linkedin.com/in/sunil-rajput-nattho-singh/">Sunil Rajput</a></p> -->

        </div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="./scripts/script.js"></script>
    <script>
        // function makeid(length) {
        //     var result = '';
        //     var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        //     var charactersLength = characters.length;
        //     for (var i = 0; i < length; i++) {
        //         result += characters.charAt(Math.floor(Math.random() * charactersLength));
        //     }
        //     return result;
        // }
        // var hash = makeid(10)
        // var clienthash = ''
        // var socket = io();
        // socket.emit('join', name, hash);


        // socket.on('users', function (users) {
        //     console.log(users)
        //     updateinbox(users)
        // });
        // socket.on('new_message', function (msg) {
        //     document.getElementById("message_box").innerHTML +=
        //         `<div class="incoming_msg">
        //             <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png"
        //                     alt="sunil"> </div>
        //             <div class="received_msg">
        //                 <div class="received_withd_msg">
        //                     <p>${msg.message}</p>
        //                     <span class="time_date"> 11:01 AM | June 9</span>
        //                 </div>
        //             </div>
        //         </div>`

        // })

        // function setclienthash(id) {
        //     console.log(id)
        //     clienthash = id
        //     getmessages()
        //     var elements = document.getElementsByClassName("chat_list")
        //     for (let i = 0; i < elements.length; i++) {
        //         if (elements.item(i).id == clienthash)
        //             elements.item(i).classList.add('active_chat')
        //         else
        //             elements.item(i).classList.remove('active_chat')
        //     }
        // }

        // function sendmessage() {
        //     var mobject = { from: hash, to: clienthash, message: $('#message').val(), time: new Date().getTime() }
        //     socket.emit('new_message', mobject)
        //     document.getElementById("message_box").innerHTML +=
        //         `<div class="outgoing_msg">
        //             <div class="sent_msg">
        //                 <p>${mobject.message}</p>
        //                 <span class="time_date"> 11:01 AM | June 9</span>
        //             </div>
        //         </div>`

        // }

        // function updateinbox(users) {
        //     var innerhtml = ''
        //     users.forEach(user => {
        //         console.log(user.hash, hash, user.name)
        //         if (user.hash != hash) {
        //             innerhtml += `
        //                 <div id="${user.hash}" onclick="setclienthash(this.id)" class="chat_list">
        //                     <div class="chat_people">
        //                         <div class="chat_img"> <img src="https://ptetutorials.com/images/user-profile.png"
        //                                 alt="sunil"> </div>
        //                         <div class="chat_ib">
        //                             <h5>${user.name} <span class="chat_date">Dec 25</span></h5>
        //                             <p>Test, which is a new approach to have all solutions
        //                                 astrology under one roof.</p>
        //                         </div>
        //                     </div>
        //                 </div>`
        //         }
        //         document.getElementById("inbox").innerHTML = innerhtml
        //     });
        // }

        // function getmessages() {
        //     fetch(`http://192.168.1.2:3000/getmessages?clientid=${hash}`)
        //         .then(data => data.json())
        //         .then(res => {
        //             console.log(res)
        //             var msg_html = ''
        //             var messages = res
        //             var clientmessages = res.filter(x => x.from == clienthash || x.to == clienthash)
        //             clientmessages.forEach(msgob => {
        //                 console.log(msgob.from, hash)
        //                 if (msgob.from == hash) {
        //                     msg_html +=
        //                         `<div class="outgoing_msg">
        //                             <div class="sent_msg">
        //                                 <p>${msgob.message}</p>
        //                                 <span class="time_date"> 11:01 AM | June 9</span>
        //                             </div>
        //                         </div>`
        //                 } else {
        //                     msg_html +=
        //                         `<div class="incoming_msg">
        //                             <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png"
        //                                     alt="sunil"> </div>
        //                             <div class="received_msg">
        //                                 <div class="received_withd_msg">
        //                                     <p>${msgob.message}</p>
        //                                     <span class="time_date"> 11:01 AM | June 9</span>
        //                                 </div>
        //                             </div>
        //                         </div>`
        //                 }
        //             })
        //             document.getElementById("message_box").innerHTML = msg_html
        //         })
        // }

    </script>
</body>

</html>


<!-- 
<div class="incoming_msg">
    <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png"
            alt="sunil"> </div>
    <div class="received_msg">
        <div class="received_withd_msg">
            <p>Test which is a new approach to have all
                solutions</p>
            <span class="time_date"> 11:01 AM | June 9</span>
        </div>
    </div>
</div>
<div class="outgoing_msg">
    <div class="sent_msg">
        <p>Test which is a new approach to have all
            solutions</p>
        <span class="time_date"> 11:01 AM | June 9</span>
    </div>
</div>
 -->